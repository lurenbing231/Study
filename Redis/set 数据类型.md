redis中set实现了集合并、交、差当操作。  
当set添加的元素2为整型且较少时，使用intset数据结构；否则，使用dict数据结构
若使用dict时，key为数据元素，value为null  
### intset转dict的条件
1、添加元素不是数字  
2、添加元素是数字，但无法用64bit（8字节）表达。
3、集合元素个数超过redis参数set-max-intset-entries配置的值。
### 交集
1、检查空集。如果出现空集，直接返回空集  
2、对各个集合按照元素个数由少到多进行排序。
3、从第一个集合依次取元素和后面集合对比，都存在时放入结果集合中。  
时间复杂度：O(N * M) N为第一个集合元素个数，M为集合个数
### 并集
遍历所有集合，把结果放到集合中。（集合会自动去重）  
时间复杂度：O(N) N为所有集合元素个数
### 差集
#### 第一种算法
对第一个集合进行遍历，依次在后面的集合中查找，当所有集合找不到时，放入结果集中  
时间复杂度：O(N * M) N为第一个集合元素个数
#### 第二种算法
1、将第一个集合中所有元素放入到中间集合中  
2、遍历后面所有集合，依次从中间集合中删除元素  
3、最后中间集合就是结果集合  
时间复杂度：O(N) N为所有集合的元素个数
#### 差集算法选择
redis会分别估算两种算法的时间复杂度，选择复杂度较低的算法。  
注意：  
1、优先选择第一个算法，因为第一个算法只有添加操作。第二个算法先添加再删除  
2、在执行第一个算法之前，会对第二个及之后的所有集合根据元素大小逆序。有利于更大的概率查找到元素，快速结束